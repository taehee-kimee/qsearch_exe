<Window x:Class="QuizHelper.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ê·¸ê¹½ì¡±ë³´ ì„¤ì¹˜í˜•"
        Width="400"
        Height="300"
        MinWidth="300"
        MinHeight="200"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ResizeMode="CanResizeWithGrip"
        MouseLeftButtonDown="Window_MouseLeftButtonDown"
        MouseEnter="Window_MouseEnter"
        MouseLeave="Window_MouseLeave">

    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Background Border (for opacity control) -->
        <Border x:Name="UiBorder" 
                Grid.RowSpan="6"
                Background="#CC000000" 
                CornerRadius="12">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.5"/>
            </Border.Effect>
        </Border>

        <!-- Header with Title and Close Button -->
        <Grid x:Name="HeaderPanel" Grid.Row="0" Margin="15,15,15,10">
            <TextBlock Text="ðŸ’¸"
                       Foreground="White"
                       FontSize="16"
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"/>
            <Button x:Name="CloseButton"
                    Content="âœ•"
                    Style="{StaticResource CloseButton}"
                    HorizontalAlignment="Right"
                    Click="CloseButton_Click"/>
        </Grid>

        <!-- Control Row: Category (left) | Area Select + Start/Stop (right) -->
        <Grid x:Name="ControlPanel" Grid.Row="1" Margin="15,0,15,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <!-- Category Dropdown (Left aligned) -->
            <ComboBox x:Name="CategoryComboBox"
                      Grid.Column="0"
                      Style="{StaticResource TransparentComboBox}"
                      ItemContainerStyle="{StaticResource TransparentComboBoxItem}"
                      SelectionChanged="CategoryComboBox_SelectionChanged"
                      MaxDropDownHeight="200">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" Foreground="White"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            
            <!-- Buttons (Right aligned) -->
            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button x:Name="SelectAreaButton"
                        Content="ðŸŽ¯ ì˜ì—­ ì„ íƒ"
                        Style="{StaticResource TransparentButton}"
                        Click="SelectAreaButton_Click"
                        MouseRightButtonUp="SelectAreaButton_RightClick"
                        ToolTip="í´ë¦­: ì°½ ì„ íƒ í›„ ì˜ì—­ ì§€ì •&#x0a;ìš°í´ë¦­: ë‹¤ë¥¸ ì°½ ì„ íƒ"
                        Margin="0,0,8,0"/>
                <Button x:Name="StartStopButton"
                        Content="â–¶ ì‹œìž‘"
                        Style="{StaticResource TransparentButton}"
                        Click="StartStopButton_Click"
                        IsEnabled="False"/>
            </StackPanel>
        </Grid>

        <!-- Selected window info -->
        <TextBlock x:Name="SelectedWindowText"
                   Grid.Row="2"
                   Text=""
                   Foreground="#88FFFFFF"
                   FontSize="10"
                   TextTrimming="CharacterEllipsis"
                   Margin="15,0,15,8"
                   Visibility="Collapsed"/>

        <!-- Result Display Area (INDEPENDENT - not inside UiBorder) -->
        <Border x:Name="ResultBorder"
                Grid.Row="3"
                Background="#22FFFFFF"
                CornerRadius="8"
                Padding="12"
                Margin="15,0,15,10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel x:Name="ResultPanel" VerticalAlignment="Center">
                    <!-- Question Text -->
                    <TextBlock x:Name="QuestionText"
                               Text=""
                               Foreground="#CCFFFFFF"
                               FontSize="13"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               Margin="0,0,0,8"
                               Visibility="Collapsed"/>
                    
                    <!-- Answer Text (Highlighted) - í´ë¦­í•˜ë©´ ë³µì‚¬ -->
                    <TextBlock x:Name="AnswerText"
                               Text=""
                               Foreground="#FFFF00"
                               FontSize="22"
                               FontWeight="Bold"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               Cursor="Hand"
                               MouseLeftButtonUp="AnswerText_Click"
                               ToolTip="í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤"
                               Visibility="Collapsed"/>
                    
                    <!-- Alternative Candidates Area -->
                    <Border x:Name="AlternativesBorder"
                            Background="#11FFFFFF"
                            CornerRadius="4"
                            Padding="8"
                            Margin="0,12,0,0"
                            Visibility="Collapsed">
                        <StackPanel>
                            <TextBlock Text="â”€â”€â”€ í˜¹ì‹œ ì´ê±´ê°€ìš”? â”€â”€â”€"
                                       Foreground="#66FFFFFF"
                                       FontSize="10"
                                       TextAlignment="Center"
                                       Margin="0,0,0,6"/>
                            <ItemsControl x:Name="AlternativesList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="0,4,0,4"
                                                    Cursor="Hand"
                                                    Background="Transparent"
                                                    MouseLeftButtonUp="AlternativeItem_Click"
                                                    ToolTip="í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤">
                                            <TextBlock Foreground="#CCFFFF00" FontSize="13" TextWrapping="Wrap">
                                                <Run Text="{Binding Rank, StringFormat={}{0}. }"/>
                                                <Run Text="{Binding Answer}" FontWeight="SemiBold"/>
                                                <Run Text="{Binding Score, StringFormat=' ({0}%)'}" Foreground="#88FFFFFF"/>
                                            </TextBlock>
                                            <TextBlock Text="{Binding Question}"
                                                       Foreground="#66FFFFFF"
                                                       FontSize="10"
                                                       TextWrapping="Wrap"
                                                       TextTrimming="CharacterEllipsis"
                                                       MaxHeight="30"
                                                       Margin="12,2,0,0"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                    
                    <!-- Default/Status Message -->
                    <TextBlock x:Name="ResultText"
                               Text="ì˜ì—­ì„ ì„ íƒí•˜ê³  ì‹œìž‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”..."
                               Foreground="#AAFFFFFF"
                               FontSize="14"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Status -->
        <TextBlock x:Name="StatusText"
                   Grid.Row="4"
                   Text="ìƒíƒœ: ì¤€ë¹„ë¨"
                   Foreground="#88FFFFFF"
                   FontSize="11"
                   Margin="15,0,15,8"/>

        <!-- Opacity Slider -->
        <Grid x:Name="OpacityPanel" Grid.Row="5" Margin="15,0,15,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Text="íˆ¬ëª…ë„:"
                       Foreground="#88FFFFFF"
                       FontSize="11"
                       VerticalAlignment="Center"
                       Margin="0,0,8,0"/>

            <Slider x:Name="OpacitySlider"
                    Grid.Column="1"
                    Minimum="0.2"
                    Maximum="1.0"
                    Value="1.0"
                    VerticalAlignment="Center"
                    ValueChanged="OpacitySlider_ValueChanged"/>

            <TextBlock x:Name="OpacityValueText"
                       Grid.Column="2"
                       Text="100%"
                       Foreground="#88FFFFFF"
                       FontSize="11"
                       VerticalAlignment="Center"
                       Width="35"
                       TextAlignment="Right"/>
        </Grid>
    </Grid>
</Window>
